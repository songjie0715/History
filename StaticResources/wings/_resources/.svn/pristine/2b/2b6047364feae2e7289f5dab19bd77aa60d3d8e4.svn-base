"use strict";define(["vue","service/commentService","components/dialog","mixin/loadingMoreMixin","components/legionConfig","components/resultTipDialog","components/loading"],function(t,e,i,o,n,s,a){return function(t,r,c){var h=new i({template:"#template-comment-dialog",data:{commentTit:"",commentDet:"",commentLen:0,errorTip:"",hasContent:!1,isErrorTip:!1,isReply:!1,noTip:"true",contentPLH:"输入评论详情",isFirst:!0,commentSelf:"评论"},events:{show:function(){},hide:function(){}},computed:{commentLen:function(){return this.commentDet.length}},methods:{hideDialog:function(){this.hide()},setCommentTit:function(){0!=this.commentTit.length&&(this.isErrorTip=!1)},setComment:function(){0!=this.commentDet.length&&(this.isErrorTip=!1),this.hasContent=!0},review:function(){var i=this;return 0==this.commentTit.length?(this.isErrorTip=!0,void(this.errorTip="请输入评论标题")):0==this.commentDet.length?(this.isErrorTip=!0,void(this.errorTip="请输入评论详情")):(a.show(),void e.review(t,i.commentTit,i.commentDet).then(function(t){switch(t.status){case 0:i.commentTit="",i.commentDet="",i.hideDialog(),a.hide(),s.show(),s.setContent("评论成功",!0),setTimeout(function(){s.hide(),l.isPrivateReview=!0},2e3),l.privateReviewList.unshift(t.result.review);break;case 1:location.href=t.url;break;case-1:break;default:alert("啊哦,出错咯")}}))},blurComment:function(){0==this.commentDet.length&&(this.hasContent=!1)},reset:function(){this.commentTit="",this.commentDet=""}}}),l=new n({el:"#app",mixins:[o],data:{isTipShow:!1,isLoading:!1,hasNoMore:!1,flag:!1,noLoading:c||!1,isAjaxLoaded:!1,ajaxReviewItems:[],isPrivateReview:!1,privateReviewList:[],likeFlag:!1},events:{scrollBottom:function(){var i=this;return this.noLoading?void(this.hasNoMore=!0):(this.isLoading=!0,void(this.flag||(this.flag=!0,e.getCommentList(t,++i.pageNum).then(function(t){1==t.status?location.href=t.url:0==t.status?(i.isAjaxLoaded=!0,i.isLoading=!1,i.flag=!1,i.ajaxReviewItems=i.ajaxReviewItems.concat(t.result.reviews.items)):t.status==-1&&(i.isLoading=!1,i.hasNoMore=!0,i.flag=!1),t.result.reviews.haveNextPage||(i.noLoading=!0)}))))}},init:function(){this.pageNum=1},attached:function(){var t=this;$(window).on("scroll",function(){window.scrollY>=300?t.isTipShow=!0:t.isTipShow=!1})},methods:{showDialog:function(){return r?void h.show():void(location.href="/accounts/login?backUrl=/review/"+t+"/list")},getLike:function(i,o){if(!this.likeFlag){var n=this,s=$(o.currentTarget),a=s.find(".likeCount"),r=s.hasClass("do");this.likeFlag=!0,r||e.likeService(t,i).then(function(t){switch(t.status){case 0:r?(s.removeClass("do"),s.data("like",!r)):(s.addClass("do"),s.data("like",!r)),n.doLike=!0,a.html(t.result.likeCount);break;case 1:location.href=t.url;break;case-1:alert("啊哦,出错了哦");break;default:alert("啊哦,出错了哦")}n.likeFlag=!1})}}}})}});
//# sourceMappingURL=../../maps/wx/controller/comment.js.map
