{"version":3,"sources":["wx/controller/bookShelfAdd.js"],"names":["define","Vue","bookShelfAddService","loadingMoreMixin","readRecordItem","bookShelfItem","haveRecordNextPage","el","mixins","data","isRecordAjaxLoaded","ajaxRecordBookItems","isShelfAjaxLoaded","ajaxShelfBookItems","actionType","hasReadRecordItem","hasBookShelfItem","isRecordLoading","recordFlag","isShelfLoading","shelfFlag","noRecordLoading","noShelfLoading","hasRecordNoMore","hasShelfNoMore","events","scrollBottom","self","this","getMoreRecordBook","recordPageNum","then","result","recentlyBooks","haveNextPage","status","location","href","url","concat","items","getMoreShelfBook","shelfPageNum","followBooks","init","attached","methods","changeTab","type"],"mappings":"AAAA,YAKAA,SACA,MACA,8BACA,0BACE,SAASC,EAAIC,EAAqBC,GAEhC,MAAO,UAASC,EAAgBC,EAAeC,GAC3C,GAAIL,IACAM,GAAI,OACJC,QAASL,GACTM,MACIC,oBAAoB,EACpBC,uBACAC,mBAAmB,EACnBC,sBACAC,WAAY,aACZC,kBAAmBX,EACnBY,iBAAkBX,EAClBY,iBAAiB,EACjBC,YAAY,EACZC,gBAAgB,EAChBC,WAAW,EACXC,iBAAkB,EAClBC,gBAAgB,EAChBC,iBAAiB,EACjBC,gBAAgB,GAEpBC,QACIC,aAAe,WACX,GAAIC,GAAOC,IAEX,IAAuB,cAAnBA,KAAKd,WAA4B,CAEjC,IAAKR,EAED,YADAsB,KAAKL,iBAAkB,EAI3B,IAAGK,KAAKP,gBAEJ,YADAO,KAAKL,iBAAkB,EAI3B,IADAK,KAAKX,iBAAkB,EACnBW,KAAKV,WAAa,MACtBS,GAAKT,YAAa,EAClBhB,EAAoB2B,oBAAoBF,EAAKG,eAAeC,KAAK,SAAStB,GACjEA,EAAKuB,OAAOC,cAAcC,eAC3BP,EAAKN,iBAAkB,GAER,GAAfZ,EAAK0B,OACLC,SAASC,KAAO5B,EAAK6B,IACC,GAAf7B,EAAK0B,SACZR,EAAKjB,oBAAqB,EAC1BiB,EAAKV,iBAAkB,EACvBU,EAAKT,YAAa,EAClBS,EAAKhB,oBAAsBgB,EAAKhB,oBAAoB4B,OAAO9B,EAAKuB,OAAOC,cAAcO,cAG1F,IAAsB,eAAnBZ,KAAKd,WAA4B,CACvC,GAAIc,KAAKN,eAEL,YADAM,KAAKJ,gBAAiB,EAI1B,IADAI,KAAKT,gBAAiB,EAClBS,KAAKR,UAAY,MACrBQ,MAAKR,WAAY,EACjBlB,EAAoBuC,mBAAmBd,EAAKe,cAAcX,KAAK,SAAStB,GAC/DA,EAAKuB,OAAOW,YAAYT,eACzBP,EAAKL,gBAAiB,GAEP,GAAfb,EAAK0B,OACLC,SAASC,KAAO5B,EAAK6B,IACC,GAAf7B,EAAK0B,SACZR,EAAKf,mBAAoB,EACzBe,EAAKR,gBAAiB,EACtBQ,EAAKP,WAAY,EACjBO,EAAKd,mBAAqBc,EAAKd,mBAAmB0B,OAAO9B,EAAKuB,OAAOW,YAAYH,aAOrGI,KAAM,WACFhB,KAAKE,cAAgB,EACrBF,KAAKc,aAAe,GAExBG,SAAS,aAGTC,SACIC,UAAW,SAASC,GAChBpB,KAAKd,WAAakC","file":"../../../wx/controller/bookShelfAdd.js","sourcesContent":["/**\n * Created by janey on 16/6/7.\n */\n\n\ndefine([\n'vue',\n'service/bookShelfAddService',\n'mixin/loadingMoreMixin'\n],function(Vue,bookShelfAddService, loadingMoreMixin){\n\n    return function(readRecordItem, bookShelfItem, haveRecordNextPage){\n        new Vue({\n            el: '#app',\n            mixins: [loadingMoreMixin],\n            data : {\n                isRecordAjaxLoaded: false,\n                ajaxRecordBookItems: [],\n                isShelfAjaxLoaded: false,\n                ajaxShelfBookItems: [],\n                actionType: 'readRecord',\n                hasReadRecordItem: readRecordItem,\n                hasBookShelfItem: bookShelfItem,\n                isRecordLoading: false,\n                recordFlag: false,\n                isShelfLoading: false,\n                shelfFlag: false,\n                noRecordLoading:  false,\n                noShelfLoading: false,\n                hasRecordNoMore: false,\n                hasShelfNoMore: false\n            },\n            events: {\n                scrollBottom : function(){\n                    var self = this;\n\n                    if( this.actionType == 'readRecord' ){\n\n                        if( !haveRecordNextPage ){\n                            this.hasRecordNoMore = true;\n                            return;\n                        }\n\n                        if(this.noRecordLoading){\n                            this.hasRecordNoMore = true;\n                            return;\n                        }\n                        this.isRecordLoading = true;\n                        if( this.recordFlag ) return;\n                        self.recordFlag = true;\n                        bookShelfAddService.getMoreRecordBook(++self.recordPageNum).then(function(data){\n                            if( !data.result.recentlyBooks.haveNextPage ){\n                                self.noRecordLoading = true;\n                            }\n                            if( data.status == 1 ){\n                                location.href = data.url;\n                            } else if( data.status == 0 ){\n                                self.isRecordAjaxLoaded = true;\n                                self.isRecordLoading = false;\n                                self.recordFlag = false;\n                                self.ajaxRecordBookItems = self.ajaxRecordBookItems.concat(data.result.recentlyBooks.items);\n                            }\n                        });\n                    } else if(this.actionType == 'followItems'){\n                        if( this.noShelfLoading ){\n                            this.hasShelfNoMore = true;\n                            return;\n                        }\n                        this.isShelfLoading = true;\n                        if( this.shelfFlag ) return;\n                        this.shelfFlag = true;\n                        bookShelfAddService.getMoreShelfBook(++self.shelfPageNum).then(function(data){\n                            if( !data.result.followBooks.haveNextPage ){\n                                self.noShelfLoading = true;\n                            }\n                            if( data.status == 1 ){\n                                location.href = data.url;\n                            } else if( data.status == 0 ){\n                                self.isShelfAjaxLoaded = true;\n                                self.isShelfLoading = false;\n                                self.shelfFlag = false;\n                                self.ajaxShelfBookItems = self.ajaxShelfBookItems.concat(data.result.followBooks.items);\n                            }\n                        });\n                    }\n\n                }\n            },\n            init: function(){\n                this.recordPageNum = 1;\n                this.shelfPageNum = 1;\n            },\n            attached:function(){\n\n            },\n            methods: {\n                changeTab: function(type){\n                    this.actionType = type;\n                }\n            }\n        });\n    }\n});\n\n"]}