{"version":3,"sources":["wxV2/controller/bookShelfAdd.js"],"names":["define","Vue","bookShelfAddService","loadingMoreMixin","readRecordItem","bookShelfItem","record","haveRecordNextPage","el","mixins","data","isRecordAjaxLoaded","ajaxRecordBookItems","isShelfAjaxLoaded","ajaxShelfBookItems","actionType","actionRecord","hasReadRecordItem","hasBookShelfItem","isRecordLoading","recordFlag","isShelfLoading","shelfFlag","noRecordLoading","noShelfLoading","hasRecordNoMore","hasShelfNoMore","events","scrollBottom","self","this","getMoreRecordBook","recordPageNum","then","result","recentlyBooks","haveNextPage","status","location","href","url","concat","items","getMoreShelfBook","shelfPageNum","followBooks","init","attached","$","cookie","document","title","methods","changeTab","type"],"mappings":"AAAA,YAKAA,SACA,MACA,8BACA,0BACE,SAASC,EAAIC,EAAqBC,GAEhC,MAAO,UAASC,EAAgBC,EAAcC,EAAQC,GAClD,GAAIN,IACAO,GAAI,OACJC,QAASN,GACTO,MACIC,oBAAoB,EACpBC,uBACAC,mBAAmB,EACnBC,sBACAC,WAAY,cACZC,aAAc,EACdC,kBAAmBb,EACnBc,iBAAkBb,EAClBc,iBAAiB,EACjBC,YAAY,EACZC,gBAAgB,EAChBC,WAAW,EACXC,iBAAkB,EAClBC,gBAAgB,EAChBC,iBAAiB,EACjBC,gBAAgB,GAEpBC,QACIC,aAAe,WACX,GAAIC,GAAOC,IAEX,IAAuB,cAAnBA,KAAKf,WAA4B,CAEjC,IAAKR,EAED,YADAuB,KAAKL,iBAAkB,EAI3B,IAAGK,KAAKP,gBAEJ,YADAO,KAAKL,iBAAkB,EAI3B,IADAK,KAAKX,iBAAkB,EACnBW,KAAKV,WAAa,MACtBS,GAAKT,YAAa,EAClBlB,EAAoB6B,oBAAoBF,EAAKG,eAAeC,KAAK,SAASvB,GACjEA,EAAKwB,OAAOC,cAAcC,eAC3BP,EAAKN,iBAAkB,GAER,GAAfb,EAAK2B,OACLC,SAASC,KAAO7B,EAAK8B,IACC,GAAf9B,EAAK2B,SACZR,EAAKlB,oBAAqB,EAC1BkB,EAAKV,iBAAkB,EACvBU,EAAKT,YAAa,EAClBS,EAAKjB,oBAAsBiB,EAAKjB,oBAAoB6B,OAAO/B,EAAKwB,OAAOC,cAAcO,cAG1F,IAAsB,eAAnBZ,KAAKf,WAA4B,CACvC,GAAIe,KAAKN,eAEL,YADAM,KAAKJ,gBAAiB,EAI1B,IADAI,KAAKT,gBAAiB,EAClBS,KAAKR,UAAY,MACrBQ,MAAKR,WAAY,EACjBpB,EAAoByC,mBAAmBd,EAAKe,cAAcX,KAAK,SAASvB,GAC/DA,EAAKwB,OAAOW,YAAYT,eACzBP,EAAKL,gBAAiB,GAEP,GAAfd,EAAK2B,OACLC,SAASC,KAAO7B,EAAK8B,IACC,GAAf9B,EAAK2B,SACZR,EAAKhB,mBAAoB,EACzBgB,EAAKR,gBAAiB,EACtBQ,EAAKP,WAAY,EACjBO,EAAKf,mBAAqBe,EAAKf,mBAAmB2B,OAAO/B,EAAKwB,OAAOW,YAAYH,aAOrGI,KAAM,WACFhB,KAAKE,cAAgB,EACrBF,KAAKc,aAAe,GAGxBG,SAAS,WACL,GAAIhC,GAAaiC,EAAEC,OAAO,aACvBlC,KACCe,KAAKf,WAAaA,GAET,GAAVT,IACCwB,KAAKf,WAAa,aAClBmC,SAASC,MAAM,SAGvBC,SACIC,UAAW,SAASC,EAAKhD,GACrBwB,KAAKf,WAAauC,EAClBxB,KAAKd,aAAeV,EACpB0C,EAAEC,OAAO,aAAaK,GACtBhB,SAASC,KAAO,wBAAwBjC","file":"../../../wxV2/controller/bookShelfAdd.js","sourcesContent":["/**\n * Created by janey on 16/6/7.\n */\n\n\ndefine([\n'vue',\n'service/bookShelfAddService',\n'mixin/loadingMoreMixin'\n],function(Vue,bookShelfAddService, loadingMoreMixin){\n\n    return function(readRecordItem, bookShelfItem,record, haveRecordNextPage){\n        new Vue({\n            el: '#app',\n            mixins: [loadingMoreMixin],\n            data : {\n                isRecordAjaxLoaded: false,\n                ajaxRecordBookItems: [],\n                isShelfAjaxLoaded: false,\n                ajaxShelfBookItems: [],\n                actionType: 'followItems',\n                actionRecord: 0,\n                hasReadRecordItem: readRecordItem,\n                hasBookShelfItem: bookShelfItem,\n                isRecordLoading: false,\n                recordFlag: false,\n                isShelfLoading: false,\n                shelfFlag: false,\n                noRecordLoading:  false,\n                noShelfLoading: false,\n                hasRecordNoMore: false,\n                hasShelfNoMore: false\n            },\n            events: {\n                scrollBottom : function(){\n                    var self = this;\n\n                    if( this.actionType == 'readRecord' ){\n\n                        if( !haveRecordNextPage ){\n                            this.hasRecordNoMore = true;\n                            return;\n                        }\n\n                        if(this.noRecordLoading){\n                            this.hasRecordNoMore = true;\n                            return;\n                        }\n                        this.isRecordLoading = true;\n                        if( this.recordFlag ) return;\n                        self.recordFlag = true;\n                        bookShelfAddService.getMoreRecordBook(++self.recordPageNum).then(function(data){\n                            if( !data.result.recentlyBooks.haveNextPage ){\n                                self.noRecordLoading = true;\n                            }\n                            if( data.status == 1 ){\n                                location.href = data.url;\n                            } else if( data.status == 0 ){\n                                self.isRecordAjaxLoaded = true;\n                                self.isRecordLoading = false;\n                                self.recordFlag = false;\n                                self.ajaxRecordBookItems = self.ajaxRecordBookItems.concat(data.result.recentlyBooks.items);\n                            }\n                        });\n                    } else if(this.actionType == 'followItems'){\n                        if( this.noShelfLoading ){\n                            this.hasShelfNoMore = true;\n                            return;\n                        }\n                        this.isShelfLoading = true;\n                        if( this.shelfFlag ) return;\n                        this.shelfFlag = true;\n                        bookShelfAddService.getMoreShelfBook(++self.shelfPageNum).then(function(data){\n                            if( !data.result.followBooks.haveNextPage ){\n                                self.noShelfLoading = true;\n                            }\n                            if( data.status == 1 ){\n                                location.href = data.url;\n                            } else if( data.status == 0 ){\n                                self.isShelfAjaxLoaded = true;\n                                self.isShelfLoading = false;\n                                self.shelfFlag = false;\n                                self.ajaxShelfBookItems = self.ajaxShelfBookItems.concat(data.result.followBooks.items);\n                            }\n                        });\n                    }\n\n                }\n            },\n            init: function(){\n                this.recordPageNum = 1;\n                this.shelfPageNum = 1;\n                \n            },\n            attached:function(){\n                var actionType = $.cookie(\"actionType\");\n                if(actionType){\n                    this.actionType = actionType;\n                }\n                if(record == 1){\n                    this.actionType = 'readRecord';\n                    document.title=\"来看阅读\";\n                }\n            },\n            methods: {\n                changeTab: function(type,record){\n                    this.actionType = type;\n                    this.actionRecord = record;\n                    $.cookie(\"actionType\",type);\n                    location.href = '/wx/i/wxshelf?record='+record;\n                }\n            }\n        });\n    }\n});\n\n"]}